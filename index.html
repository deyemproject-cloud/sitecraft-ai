<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SiteCraft AI - Crea siti web con l'AI</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --bg: #0f0f23;
            --surface: #1a1a2e;
            --surface-light: #252542;
            --text: #f8fafc;
            --text-muted: #94a3b8;
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .font-display { font-family: 'Space Grotesk', sans-serif; }
        #root { min-height: 100vh; }
        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        const API_URL = 'http://localhost:3001/api';

        // API Functions
        const api = {
            generateSite: async (prompt, userId) => {
                try {
                    const response = await fetch(`${API_URL}/generate`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt, userId })
                    });
                    if (!response.ok) throw new Error('Generation failed');
                    return await response.json();
                } catch (error) {
                    console.error('API Error:', error);
                    throw error;
                }
            },
            getSites: async (userId) => {
                try {
                    const response = await fetch(`${API_URL}/sites?userId=${userId}`);
                    return await response.json();
                } catch (error) {
                    console.error('API Error:', error);
                    return [];
                }
            }
        };

        const useAuth = () => {
            const [user, setUser] = useState(() => {
                const saved = localStorage.getItem('sitecraft_user');
                return saved ? JSON.parse(saved) : null;
            });
            const login = (email) => {
                const mockUser = { id: 'user-' + Date.now(), email, name: email.split('@')[0], plan: 'pro' };
                localStorage.setItem('sitecraft_user', JSON.stringify(mockUser));
                setUser(mockUser);
            };
            const logout = () => {
                localStorage.removeItem('sitecraft_user');
                setUser(null);
            };
            return { user, login, logout };
        };

        const Landing = ({ onStart }) => (
            <div style={{ minHeight: '100vh' }}>
                <nav style={{ padding: '1.5rem 3rem', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                    <div className="font-display gradient-text" style={{ fontSize: '1.5rem', fontWeight: 700 }}>SiteCraft</div>
                    <div style={{ display: 'flex', gap: '2rem', alignItems: 'center' }}>
                        <a href="#features" style={{ color: 'var(--text-muted)', textDecoration: 'none' }}>Funzionalit√†</a>
                        <a href="#pricing" style={{ color: 'var(--text-muted)', textDecoration: 'none' }}>Prezzi</a>
                        <button onClick={onStart} style={{ padding: '0.75rem 1.5rem', background: 'linear-gradient(135deg, var(--primary), var(--secondary))', border: 'none', borderRadius: '8px', color: 'white', cursor: 'pointer', fontWeight: 600 }}>
                            Inizia Gratis
                        </button>
                    </div>
                </nav>
                
                <section style={{ padding: '6rem 2rem', textAlign: 'center' }}>
                    <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.6 }}>
                        <div style={{ display: 'inline-flex', alignItems: 'center', gap: '0.5rem', padding: '0.5rem 1rem', background: 'rgba(99,102,241,0.1)', border: '1px solid rgba(99,102,241,0.3)', borderRadius: '100px', marginBottom: '2rem' }}>
                            <span className="pulse" style={{ width: '8px', height: '8px', background: '#22c55e', borderRadius: '50%' }}></span>
                            <span style={{ fontSize: '0.875rem', color: '#a5b4fc' }}>Powered by GPT-4</span>
                        </div>
                        
                        <h1 className="font-display" style={{ fontSize: 'clamp(3rem, 6vw, 5rem)', marginBottom: '1.5rem', lineHeight: 1.1 }}>
                            Crea siti web con<br /><span className="gradient-text">l'intelligenza artificiale</span>
                        </h1>
                        <p style={{ color: 'var(--text-muted)', fontSize: '1.25rem', marginBottom: '3rem', maxWidth: '600px', margin: '0 auto 3rem', lineHeight: 1.6 }}>
                            Descrivi il sito dei tuoi sogni in linguaggio naturale. La nostra AI genera codice pulito, design moderno e animazioni fluide in pochi secondi.
                        </p>
                        <motion.button onClick={onStart} whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }} style={{ padding: '1.25rem 3rem', fontSize: '1.1rem', background: 'linear-gradient(135deg, var(--primary), var(--secondary))', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, boxShadow: '0 10px 40px rgba(99, 102, 241, 0.4)' }}>
                            üöÄ Prova Gratuitamente
                        </motion.button>
                        
                        <div style={{ display: 'flex', gap: '4rem', justifyContent: 'center', marginTop: '5rem', flexWrap: 'wrap' }}>
                            {[{n:'10K+',l:'Siti Creati'},{n:'< 30s',l:'Tempo Medio'},{n:'99%',l:'Soddisfazione'}].map((s,i) => (
                                <motion.div key={i} initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.5 + i*0.1 }}>
                                    <div className="font-display gradient-text" style={{ fontSize: '2.5rem', fontWeight: 700 }}>{s.n}</div>
                                    <div style={{ color: 'var(--text-muted)' }}>{s.l}</div>
                                </motion.div>
                            ))}
                        </div>
                    </motion.div>
                </section>

                <section id="features" style={{ padding: '6rem 2rem' }}>
                    <div style={{ maxWidth: '1200px', margin: '0 auto' }}>
                        <h2 className="font-display" style={{ fontSize: '2.5rem', textAlign: 'center', marginBottom: '4rem' }}>Come funziona</h2>
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '2rem' }}>
                            {[{step:'01',title:'Descrivi',desc:'Scrivi in linguaggio naturale che tipo di sito vuoi. Nessuna competenza tecnica richiesta.'},{step:'02',title:'Genera',desc:'La nostra AI analizza la richiesta e crea codice HTML, CSS e JavaScript ottimizzato.'},{step:'03',title:'Pubblica',desc:'Ottieni un link immediato. Modifica, personalizza e condividi il tuo sito.'}].map((f,i) => (
                                <motion.div key={i} className="glass" style={{ padding: '2.5rem', borderRadius: '20px', position: 'relative' }} whileHover={{ y: -5 }}>
                                    <div style={{ fontSize: '4rem', fontWeight: 700, color: 'rgba(99,102,241,0.2)', position: 'absolute', top: '1rem', right: '1.5rem', fontFamily: 'Space Grotesk' }}>{f.step}</div>
                                    <h3 className="font-display" style={{ fontSize: '1.5rem', marginBottom: '1rem' }}>{f.title}</h3>
                                    <p style={{ color: 'var(--text-muted)' }}>{f.desc}</p>
                                </motion.div>
                            ))}
                        </div>
                    </div>
                </section>
            </div>
        );

        const Dashboard = ({ user, onLogout }) => {
            const [activeTab, setActiveTab] = useState('create');
            const [prompt, setPrompt] = useState('');
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState(null);
            const [sites, setSites] = useState([]);

            useEffect(() => {
                if (user) loadSites();
            }, [user]);

            const loadSites = async () => {
                const userSites = await api.getSites(user.id);
                setSites(userSites);
            };

            const generate = async () => {
                if (!prompt) return;
                setLoading(true);
                setError(null);
                try {
                    const data = await api.generateSite(prompt, user.id);
                    setResult(data.site);
                    loadSites();
                } catch (err) {
                    setError('Errore nella generazione. Verifica che il backend sia attivo su localhost:3001');
                }
                setLoading(false);
            };

            return (
                <div style={{ minHeight: '100vh', display: 'flex' }}>
                    <aside style={{ width: '280px', background: 'var(--surface)', padding: '2rem', borderRight: '1px solid rgba(255,255,255,0.05)', display: 'flex', flexDirection: 'column' }}>
                        <div className="font-display gradient-text" style={{ fontSize: '1.5rem', fontWeight: 700, marginBottom: '3rem' }}>SiteCraft</div>
                        <nav style={{ flex: 1 }}>
                            {[{id:'create',icon:'‚ú®',label:'Crea Sito'},{id:'sites',icon:'üåê',label:'I Miei Siti'},{id:'settings',icon:'‚öôÔ∏è',label:'Impostazioni'}].map(item => (
                                <motion.div key={item.id} onClick={() => setActiveTab(item.id)} whileHover={{ x: 5 }} style={{ display: 'flex', alignItems: 'center', gap: '1rem', padding: '1rem', background: activeTab === item.id ? 'rgba(99,102,241,0.2)' : 'transparent', borderRadius: '12px', color: activeTab === item.id ? 'white' : 'var(--text-muted)', cursor: 'pointer', marginBottom: '0.5rem' }}>
                                    <span>{item.icon}</span>{item.label}
                                </motion.div>
                            ))}
                        </nav>
                        <div style={{ paddingTop: '2rem', borderTop: '1px solid rgba(255,255,255,0.1)' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '1rem' }}>
                                <div style={{ width: '40px', height: '40px', background: 'linear-gradient(135deg, var(--primary), var(--secondary))', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 600 }}>{user.name[0].toUpperCase()}</div>
                                <div><div style={{ fontWeight: 500 }}>{user.name}</div><div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>Pro Plan</div></div>
                            </div>
                            <button onClick={onLogout} style={{ width: '100%', padding: '0.75rem', background: 'transparent', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '8px', color: 'var(--text-muted)', cursor: 'pointer' }}>Logout</button>
                        </div>
                    </aside>

                    <main style={{ flex: 1, padding: '3rem', overflowY: 'auto' }}>
                        <AnimatePresence mode="wait">
                            {activeTab === 'create' && (
                                <motion.div key="create" initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }}>
                                    <h1 className="font-display" style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>Crea il tuo sito</h1>
                                    <p style={{ color: 'var(--text-muted)', marginBottom: '2rem' }}>Descrivi cosa vuoi e lascia che l'AI faccia il resto</p>

                                    <div className="glass" style={{ padding: '2rem', borderRadius: '20px', marginBottom: '2rem' }}>
                                        <label style={{ display: 'block', marginBottom: '0.75rem', fontSize: '0.9rem', color: 'var(--text-muted)' }}>Descrivi il tuo sito</label>
                                        <textarea value={prompt} onChange={(e) => setPrompt(e.target.value)} placeholder="Es: Un sito per una gelateria artigianale in centro a Milano. Stile vintage, colori pastello, foto di gelati artigianali, menu, contatti e mappa. Design elegante e moderno..." style={{ width: '100%', minHeight: '150px', padding: '1rem', background: 'rgba(0,0,0,0.3)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '12px', color: 'white', fontSize: '1rem', resize: 'vertical', marginBottom: '1.5rem' }} />
                                        
                                        <motion.button onClick={generate} disabled={!prompt || loading} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} style={{ padding: '1rem 2rem', background: loading ? 'rgba(99,102,241,0.5)' : 'linear-gradient(135deg, var(--primary), var(--secondary))', border: 'none', borderRadius: '10px', color: 'white', fontWeight: 600, cursor: !prompt || loading ? 'not-allowed' : 'pointer', opacity: !prompt || loading ? 0.7 : 1, display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                                            {loading ? <><span className="spin">‚ö°</span> Generazione in corso...</> : <><span>‚ú®</span> Genera Sito</>}
                                        </motion.button>

                                        {error && <div style={{ marginTop: '1rem', padding: '1rem', background: 'rgba(239,68,68,0.1)', border: '1px solid rgba(239,68,68,0.3)', borderRadius: '8px', color: '#ef4444' }}>{error}</div>}
                                    </div>

                                    {result && (
                                        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="glass" style={{ padding: '2rem', borderRadius: '20px', border: '1px solid rgba(99,102,241,0.3)' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
                                                <div>
                                                    <h3 style={{ fontSize: '1.25rem', marginBottom: '0.25rem' }}>‚úÖ Sito generato con successo!</h3>
                                                    <p style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Creato in pochi secondi con GPT-4</p>
                                                </div>
                                            </div>
                                            <div style={{ background: 'rgba(0,0,0,0.3)', borderRadius: '12px', padding: '1rem', marginBottom: '1.5rem', fontFamily: 'monospace', fontSize: '0.9rem', color: 'var(--text-muted)' }}>
                                                {result.url}
                                            </div>
                                            <div style={{ display: 'flex', gap: '1rem' }}>
                                                <a href={result.url} target="_blank" rel="noopener noreferrer" style={{ padding: '0.75rem 1.5rem', background: 'linear-gradient(135deg, var(--primary), var(--secondary))', border: 'none', borderRadius: '8px', color: 'white', textDecoration: 'none', fontWeight: 600 }}>üöÄ Visualizza Sito</a>
                                                <button onClick={() => {setResult(null); setPrompt('');}} style={{ padding: '0.75rem 1.5rem', background: 'transparent', border: '1px solid rgba(255,255,255,0.2)', borderRadius: '8px', color: 'white', cursor: 'pointer' }}>Crea Nuovo</button>
                                            </div>
                                        </motion.div>
                                    )}
                                </motion.div>
                            )}

                            {activeTab === 'sites' && (
                                <motion.div key="sites" initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }}>
                                    <h1 className="font-display" style={{ fontSize: '2rem', marginBottom: '2rem' }}>I miei siti</h1>
                                    {sites.length === 0 ? (
                                        <div className="glass" style={{ padding: '3rem', textAlign: 'center', borderRadius: '20px' }}>
                                            <p style={{ color: 'var(--text-muted)' }}>Nessun sito ancora creato. Inizia ora!</p>
                                            <button onClick={() => setActiveTab('create')} style={{ marginTop: '1rem', padding: '0.75rem 1.5rem', background: 'var(--primary)', border: 'none', borderRadius: '8px', color: 'white', cursor: 'pointer' }}>Crea il tuo primo sito</button>
                                        </div>
                                    ) : (
                                        <div style={{ display: 'grid', gap: '1.5rem' }}>
                                            {sites.map((site, i) => (
                                                <motion.div key={site.id} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: i * 0.1 }} className="glass" style={{ padding: '1.5rem', borderRadius: '16px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                    <div>
                                                        <h3 style={{ marginBottom: '0.25rem' }}>{site.prompt}</h3>
                                                        <p style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>{site.url}</p>
                                                    </div>
                                                    <div style={{ display: 'flex', gap: '1rem' }}>
                                                        <a href={site.url} target="_blank" rel="noopener noreferrer" style={{ padding: '0.5rem 1rem', background: 'rgba(99,102,241,0.2)', border: '1px solid rgba(99,102,241,0.3)', borderRadius: '6px', color: 'white', textDecoration: 'none', fontSize: '0.85rem' }}>Apri</a>
                                                    </div>
                                                </motion.div>
                                            ))}
                                        </div>
                                    )}
                                </motion.div>
                            )}
                        </AnimatePresence>
                    </main>
                </div>
            );
        };

        const Login = ({ onLogin, onBack }) => {
            const [email, setEmail] = useState('');
            return (
                <div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '2rem' }}>
                    <motion.div initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} className="glass" style={{ padding: '3rem', borderRadius: '24px', width: '100%', maxWidth: '420px' }}>
                        <button onClick={onBack} style={{ background: 'transparent', border: 'none', color: 'var(--text-muted)', cursor: 'pointer', marginBottom: '1.5rem' }}>‚Üê Torna indietro</button>
                        <h1 className="font-display" style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>Bentornato</h1>
                        <p style={{ color: 'var(--text-muted)', marginBottom: '2rem' }}>Accedi per creare siti con l'AI</p>
                        <input type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="tu@email.com" style={{ width: '100%', padding: '1rem', background: 'rgba(0,0,0,0.3)', border: '1px solid rgba(255,255,255,0.1)', borderRadius: '10px', color: 'white', fontSize: '1rem', marginBottom: '1.5rem' }} />
                        <motion.button onClick={() => onLogin(email || 'user@example.com')} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} style={{ width: '100%', padding: '1rem', background: 'linear-gradient(135deg, var(--primary), var(--secondary))', border: 'none', borderRadius: '10px', color: 'white', fontWeight: 600, cursor: 'pointer' }}>Accedi</motion.button>
                        <p style={{ textAlign: 'center', marginTop: '1.5rem', fontSize: '0.85rem', color: 'var(--text-muted)' }}>Demo - inserisci qualsiasi email</p>
                    </motion.div>
                </div>
            );
        };

        const App = () => {
            const { user, login, logout } = useAuth();
            const [view, setView] = useState('landing');

            if (user) return <Dashboard user={user} onLogout={logout} />;
            if (view === 'login') return <Login onLogin={login} onBack={() => setView('landing')} />;
            return <Landing onStart={() => setView('login')} />;
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
